Программа для отправки команд на несколько устройств через Telnet
Программа может запускаться без прав администратора

ВНИМАНИЕ!!! Программа не тестировалась должным образом и может отработать крайне непредсказуемо.
Рекомендуется для начала делать выборку на 5-10 устройствах и проверять вручную корректность результата на самом оборудовании.

Страница проекта:  github.com/finger1610/MartsTelnet
Если есть предложения или обнаружили баг в работе программы, пишите на почту martsev.96@gmail.com 

#####################################################################################################
Назначение:
Отправка пользовательского набора команд на список оборудования из txt файла.
Единоразованя авторизация через поля в программе (далее по этим данным программа подключается к оборудованию).
Логирование результата отрправки на каждое оборудование с возможностью сохранения лога.
Фиксация ошибок доступности оборудования или разрыва сесси подключения (с возможностью сохранения лога).
Поиск определенного параметра (например, версия ОС) с сохранением конкретной строки и последующим логированием в файл. 

#####################################################################################################
Небольшая инструкция:
для работы программы трубуется соединение с сетью с необходимым оборудованием (проверить можно через кнопку "Test Connect").

Для запуска не требуется установка дополнительных компонентов.
Запуск программы выполняется через MartsTelnet.exe

Обязательные поля:
1)Введите логин и пароль в соответствующих полях для авторизации на оборудовании. 
(Программа не понимает, корректный логин/пароль или нет. Порверяйте через Test Connect)

2)введите/выберите путь к файлу с IP адресами в поле "File To IP.txt" (по кнопке "..." можно выбрать путь к файлу через проводник).
Программа самостоятельно просканирует файл на наличие IP адресов построчно, уберёт лишние фразы и загрузит их в программу без изменения исходного файла.
В поле "File to IP.txt" выводится путь к файлу, но его редактирование не влияет на реально запрашиваемый файл. 
После сканирования файла над конопкой "Проверить список" появится уведомление с колличеством найденных адресов.
Проверить выгруженные адреса можно через кнопку "Проверить список".
В списке отредактировать адреса нет возможности (пока что), по этому правки осуществляйте в исходном txt файле, указанном в програме.
Отфильтрованный список можно сохранить новым файлом. Это может быть полезным, так как программа построчно ищет ip адреса и сохраняет только их.
По умолчанию имя файла "List IP addresses.txt"
Фича: можно скормить программе лог из предыдущих запусков (например, из лога ошибок) и она сама отфильтрует IP адреса от мусора, расположив каждый на новой строчке.

3) По нажатию кнопки "Команды" откроетя окно для ввода текста. Введите одну или несколько команд с разделением на строки для отправки их на устройства.
Проверьте синтаксис, так как строки будут отправляться в том же виде и порядке, как они были введены в программу. 
НЕ ДОБАВЛЯЙТЕ КОМАНДУ НА ВЫХОД С УТСРОЙТСВА! Это может очень сильно увеличить время выполнения отправки команд.
После ввода команд нажмите кнопку "Add". При добавлении команд над кнопкой появится сообщение о наличии команд.
Если необходимо сохранить пустые строки от исходного набора команд, то уберите флог "Автоудаление пустых строк".
Можно сначала добавить команды с автоудалением пустых строк, а после снова открыть команды, вручную добавить пустые строки и сохранить без автоудаления.
Это позволяет избежать лишних пустых строк.

Для отчистки введенного списка нажмите "Отчистить" в поле ввода команд.
Запуск программы возможен и без комманд. Например, для проверки доступности оборудования.

После заполненеия этих ключевых полей станут доступны кнопки "Test Connect" и "Run"
#Test Connect - кнопка, отпрпавляющая логин, пароль и набор команд на первое устройство из списка IP адресов.
После выполнения выводится окно с результатом работы от данного оборудвоания. В лог не записывается.

#Run - кнопка, запускающая автоматический цикл захода на каждое оборудвание из списка. 
Появляется шкала прогресса, статус отпрвки на устройство, отправленное/общее колличество устройств и время выполнения.
Так же появляется кнопка "Stop" для остановки процесса отправки. При повторном запуске процесс начнется с начала.


#####################################################################################################
Последовательность работы:
После нажатия кнопки "Run" блокируются все поля ввода и кнопки, кроме кнопки "Stop" и флагов "Show Mеssage", "Сохранить весь лог"
Авторизация по указанному в программе логину и паролю. 
Далее отправляется набор команд, указанный в предыдущем пункте.
после каждой команды ведется запись в лог. Лог можно посмотреть после выполнения программы.
General log - общий лог со всеми попытками подключения и отпрправки команд.
В начале лога пишется:
исходное колличество устройств, 
комманды на отправку, порт подключения, колличество успешных проходов,
время выполнения, 
сервисная информация о использованных функциях программы (фильтр, ожидание вывода, команды действия),если они использовались.

Success Log - лог успешных проходов по оборудованию.
В случае ошибки подключения или иной ошибки появится кнопка "Ошибки:__" c колличеством ошибок, возникших в процессе выполнения.
Просмотреть ошибки можно после завершения цикла работы "Run" или после остановки процесса.

В логе ошибок указывается только IP адрес и ошибка. 
Этот лог так же можно сохранить. По умолчанию имя файла "Errors.txt"

Когда закончится процесс отправки, поля для ввода станут доступны, а так же станут доступны кнопки с логами и ошибками.


Логи и ошибки можно сохранить в файл кнопкой "Сохранить в файл" при просмотре лога.
Так же можно заранее (или в процессе выполнения) нажать флаг "Сохранить весь лог"
и после выполнения программы все экземпляры лога (General, Success, Errors) сохранятся в последнем каталоге с именем файла с ip адресами 
(прим: файл ip.txt, папка ip.txt_log)


#####################################################################################################

Опциональные функции:
0) Клавиша "Дополнительно" открывает меню с установкой времени отклика нна авторизацию и отправку команд.
Позволяет увеличить время отклика для исполнения долгих команд (например обновление прошивки).
Без корректировки по истечению времени программа просто отключится от устройства, не выполнив оставшиеся команды и  запишет попытку в ошибку.
в этом подменю время отклика можно сбросить на заводские (10 секунд).
Для применеия новго времени отклика обязательно нажимать "Apply".

1)Динамическая замена. позволяет динамически менять слово или словосочетание в командах в момент выполнения программы.
Для работы необходимо указать необходимое слово в txt файле с IP через 1 пробел.


Пример:
txt файл
10.10.10.1 1010
10.10.10.2 1012


комманды:
delete vlan %%%
save conf


результат: при отправке на 10.10.10.1 "%%%" будет заменена на 1010 и первая команда будет выглядеть так: delete vlan 1010
при отправке на 10.10.10.2 команда уже будет delete vlan 1012

Эта функция создавалась для прописания параметров с указанием asccess vlan , где у каждого коммутатора он свой. 
на каждом наборе оборудвоания вланы были разные, по этому было релизовано такое решение.

2)При необходимости укажите порт для подключения (по умолчанию установлен порт 23)

3)При необходимости в поле "Фильтр" укажите фразу, которая должна встретиться после авторизации.
Если данной фразы не будет, то порграмма разорвет соединение с данным устройством.
Данное поле позволит отсеивать устройства, имеющие разное назначение на сети (например, оборудвание разных вендоров).
Пример: на сети установлено 10 устройств с именами, начинающихся на "ETH_", и 4 устройства с именами, начинающихся на "OSW_". 
При установке фильтра "ETH" программа после авторизации проверит наличие слова-фильтра и если слово присутствует,
то прорамма отправит заготовленный набор команд на устройство.
Если слова нет, то разорвет соединение и перейдет к следующему в списке IP адресу, добавив текущее устройство в лог "Errors".

4)При необходимости в поле "Ожидание вывода" введите фразу, для поиска её после отправки каждой команды на устройство. 
Когда команда отрпавятся, программа проверит наличие данной фразы в ответах от устройства.
Если фраза встретися хотя бы 1 раз, то в лог запишутся только те строки, которые содержат это слово.
Если фразы нет, то будет выполнена запись в лог "Errors"
5) После добавления фразы в Ожидание вывода, появится возможность добавить команды (кнопка "Действие") в слуае обнаружения этих фраз в ответе от оборудования.
Это не прерывает основной ход выполнения основных комманд, а вставляет дополнительный набор комманд  сразу после обнаружения нужного ответа.
Пример: 
Основной набор команд:
show os versoin
save config



Ожидание вывода: M38
Дополнительный набор команд:
configure
OS update to M54
quit

Результат:
После каждой строчки ответа от оборудования программа будет искать фразу "М38" и как только найдет её (в данном случае после соновной команды show config), 
то тут же отправит дополнительную команду. Когда доп команда отправится, то следующим будет отправлено продолжение основных команд (save config).

6) Флаг "Выборочно" позволяет отправлять дополнительные команды только после строчки в основном наборе команд, начинающейся с ###.
Пример:
Основной набор команд:
configure
int g 1/0/1
###show int g 1/0/1 conf
q

int g 1/0/2
###show int g 1/0/2 conf
q

(аналогично до 24 порта)

Ожидание вывода: description 2floor
Дополнительный набор команд:
clear config


int g 1/0/24
###show int g 1/0/24 conf
q

save config


7) Флаг "Инвертировать" позволяет отправлять дополнительный набор комманд каждый раз, когда программа НЕ НАХОДИТ ключеволе слово при ответе от оборудования.
Крайне рекомендуется использовать этот флаг совместно с флагом "Выборочно", иначе ДЕЙСТВИЕ будет выполняться после каждой строки, где не будет слова из "Ожидание вывода"

Пример
Задача: прописать набор настроек №1 на 24 портах коммутатора. Есть 3 порта, имеющих в описании "OSW", где настройки прописывать не надо.
Решение: указать в поле "ожидание вывода" слово "OSW" как фильтр, установить флаг "Выборочно", а в кнопке "Действие" добавить набор настроек №2, которые нужно прописать на всех портах.
В основном наборе команд прописываем таким образом чтобы программа поочередно заходила на каждый порт и запрашивала описание (как в примере выше).
В дооплнительном наборе прописываем необходимые настройки для тех портов, где нам нужно что-то прописать (например какой-то влан).
Ставим галочку "Инвертировать" и программа будет выполнять основной набор комманд №1 + комманды №2, за исключением тех портов, что имеют описание "OSW".
на "OSW" ничего прописано не будет.


8)Флаг "Show Mеssage" - По сути, полуавтоматический режим работы для кнопки "Run". 
При установке этого фалга будет выводиться результат работы с каждым оборудованием, как при нажатии на "Test Connect", но в нажатии на "Run".
Пока окно вывода открыто, отправки на следующее устройство не будет. Для отмены дальнейшего выполнения команд нажмите "Cancel". Программа остановит дальнуйшую отправку.

9)Флаг "Сохранить весь лог" говоирт сама за себя. Можно нажать либо до нажатия кнопки "Run", либо после выполнения. 
После выполнения появится окно, которое предложит место для сохранения всего записанного лога в отдельной папке. 
В папке будут 2 или 3 лога в зависимости от результата выполнения.
Примечание: Ничего не мешает сохранять каждый экземпляр лога в ручную после предварительного просмотра.

10) для сброса всех полей и корманд нажмите кнопку "Reset"
#####################################################################################################