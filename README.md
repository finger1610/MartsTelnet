# MartsTelnet
my Telnet programm
Программа для отправки команд на несколько устройств через Telnet
Программа может запускаться без прав администратора

ВНИМАНИЕ!!! Программа не тестировалась должным образом и может отработать крайне непредсказуемо.
Рекомендуется для начала делать выборку на 5-10 устройствах и проверять вручную корректность результата на самом оборудовании.
Программа тестировалась с неизменяемом набором комманд на 2500 устройствах. 
Так же при помощи данной программы делалсь выгрузка и сортировка по версиям ОС на оброрудовании.
Динамическая замена на март 2022 года не тестировалась.

Страница проекта:  github.com/finger1610/MartsTelnet
#####################################################################################################
Назначение:
Отправка пользовательского набора команд на список оборудования из txt файла.
Единоразованя авторизация через поля в программе (далее по этим данным программа подключается к оборудованию).
Логирование результата отрпавки на каждое оборудование с возможностью сохранения лога.
Фиксация ошибок доступности оборудования или разрыва сесси подключения (с возможностью сохранения лога)

#####################################################################################################
Небольшая инструкция:
для работы программы трубуется соединение с сетью с необходимым оборудованием (проверить можно через кнопку "Test Connect").

Для запуска не требуется установка дополнительных компонентов.
Запуск программы выполняется через MartsTelnet.exe

Обязательные поля:
1)Введите логин и пароль в соответствующих полях для авторизации на оборудовании. 
(Программа не понимает, корректный логин/пароль или нет. Порверяйте через Test Connect)

2)введите/выберите путь к файлу с IP адресами в поле "File To IP.txt" (по кнопке "..." можно выбрать путь к файлу через проводник).
Программа самостоятельно просканирует файл на наличие IP адресов, уберёт лишние фразы и загрузит из в программу без изменения исходного файла.
После сканирования файла над конопкой "Проверить список" появится уведомление с колличеством неайденных адресов.
Проверить выгруженные адреса можно через кнопку "Проверить список".
В списке отредактировать адреса нет возможности (пока что), по этому правки осуществляйте в исходном txt файле, указанном в програме.
Отфильтрованный список можно сохранить новым файлом. По умолчанию имя файла "List IP addresses.txt"

3) По нажатию кнопки "Команды" откроетя окно для ввода текста. Введите одну или несколько команд с разделением на строки для отправки их на устройства.
Проверьте синтаксис, так как строки будут отправляться в том же виде и порядке, как они были введены в программу. 
НЕ ДОБАВЛЯЙТЕ КОМАНДУ НА ВЫХОД С УТСРОЙТСВА! Это может очень сильно увеличить время выполнения отправки команд.
После ввода команд нажмите кнопку "Add". При добавлении команд над кнопкой появится сообщение о наличии команд.

После заполненеия этих ключевых полей станут доступны кнопки "Test Connect" и "Run"
#Test Connect - кнопка, отпрпавляющая логин, пароль и набор команд на первое устройство из списка IP адресов.
После выполнения выводится окно с результатом работы от данного оборудвоания. В лог не записывается.

#Run - кнопка, запускающая автоматический цикл захода на каждое оборудвание из списка. 
Появляется шкала прогресса, статус отпрвки на устройство, отправленное/общее колличество устройств и время выполнения.
Так же появляется кнопка "Stop" для остановки процесса отправки. При повторном запуске процесс начнется с начала.


#####################################################################################################
Последовательность работы:
После нажатия кнопки "Run" блокируются все поля ввода и кнопки, кроме кнопки "Stop" и флага "Show Mеssage"
Авторизация по указанному в программе логину и паролю. 
Далее отправляется набор команд, указанный в предыдущем пункте.
после каждой команды ведется запись в лог. Лог можно посмотреть после выполнения программы.
В случае ошибки подключения или иной ошибки появится кнопка "Ошибки:__" c колличеством ошибок, возникших в процессе выполнения.
Просмотреть ошибки можно после завершения цикла работы "Run" или после остановки процесса.
Когда закончится процесс отправки, поля для ввода станут доступны, а так ж станут доступны кнопки "Log", "Ошибки:__".

При нажатии на кнопку "log" появится окно с результатом работы.
В первых строках отображена общая информация (кроме логина и пароля), а далее указан IP адрес и ответы оборудвоания на вводы команд (в том числе и ошибки).
При нажатии на кнопку "ОК", окно лога закроется. 
При нажатии на пнопку "Сохранить в файл" появится окно проводника для сохранения файла. по умолчанию имя файла "Log.txt"

При нажатии на пнопку "Ошибки:__" появится окно с логом ошибок.
В логе ошибок указывается только IP адрес и ошибка. 
Этот лог так же можно сохранить. По умолчанию имя файла "Errors.txt"

#####################################################################################################

Опциональные функции:
1)Динамическая замена. позволяет динамически менять слово или словосочетание в командах в момент выполнения программы.
Для работы необходимо указать необходимое слово в txt файле с IP через 1 пробел.

Пример:
txt файл
10.10.10.12 reboot
10.10.10.12 save conf

комманды:
delete vlan 1010
%%%

резултьтат: "%%%" в первом случае будет заменено на "reboot", а во втором на "save conf".

Эта функция создавалась для прописания параметров с указанием asccess vlan в каждой настройке. 
на каждом наборе оборудвоания вланы были разные, по этому было релизовано такое решение.

2)При необходимости укажите порт для подключения (по умолчанию установлен порт 23)

3)При необходимости в поле "Фильтр" укажите фразу, которая должна встретиться после авторизации.
Если данной фразы не будет, то порграмма разорвет соединение с данным устройством.
Данное поле позволит отсеивать устройства, имеющие разное назначение на сети (например, оборудвание разных вендоров).
Пример: на сети установлено 10 устройств с именами, начинающихся на "ETH_", и 4 устройства с именами, начинающихся на "OSW_". 
При установке фильтра "ETH" программа после авторизации проверит наличие слова-фильтра и если слово присутствует,
то прорамма отправит заготовленный набор команд на устройство.
Если слова нет, то разорвет соединение и перейдет к следующему в списке IP адресу, добавив текущее устройство в лог "Errors".

4)При необходимости в поле "Ожидание вывода" введите фразу, для поиска её после отправки команд на устройство. 
Когда команды отрпавятся, программа проверит наличие данной фразы в ответах от устройства.
Если фраза встретися, то в лог запишутся только те строки, которые содержат это слово.
Если фразы нет, то будет выполнена запись в лог "Errors"
5) После добавления фразы в Ожидание вывода, появится возможность добавить команды (кнопка "Действие") в слуае обнаружения этих фраз в ответе от оборудования.
Это не прерывает основной ход выполнения основных комманд, а вставляет дополнительный набор комманд  сразу после обнаружения нужного ответа.
6) Флаг "Инвертировать" позволяет отправлять дополнительный набор комманд каждый раз, колгда программа НЕ НАХОДИТ ключеволе слово при ответе от оборудования.
Пример: 
Задача: прописать набор настроек №1 на 24 портах коммутатора. Есть 3 порта, имеющих в описании "OSW", где настройки прописывать не надо.
Решение: указать в поле "ожидание вывода" слово "OSW" как фильтр, а в кнопке "Действие" добавить набор настроек №2, которые нужно прописать на всех портах.
Ставим галочку "Инвертировать" и программа будет выполнять основной набор комманд №1 + комманды №2, за исключением тех портов, что имеют описание "OSW".
на "OSW" пропишутся только команды №1.  

7)Флаг "Show Mеssage" - По сути, полуавтоматический режим работы для кнопки "Run". 
При установке этого фалга будет выводиться результат работы с каждым оборудованием, как при нажатии на "Test Connect", но в нажатии на "Run".
Пока окно вывода открыто, отправки на следующее устройство не будет.

8)Флаг "Сохранить весь лог" говоирт сама за себя. Можно нажать либо до нажатия кнопки "Run", либо после. 
После выполнения появится окно, которое предложит место для сохранения всего записанного лога в отдельной папке. 
В папке будут 2 или 3 лога в зависимости от результата выполнения.
Примечание: Ничего не мешает сохранять каждый экземпляр лога в ручную после предварительного просмотра.

9) для сброса всех полей и корманд нажмите кнопку "Reset"
#####################################################################################################
